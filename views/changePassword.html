<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name='csrf-token' content={{ csrfToken }}>
    <title></title>
    <script src="/js/libs/jquery/dist/jquery.min.js"></script>
    <link rel="stylesheet" href="/css/icons.css" type="text/css"/>
    <style>
        h2,h3,span{color:#546e7a}
        h3{font-size: 15px}
        .login-button,h2,h3{text-align:center}
        *{box-sizing:border-box}
        body{margin:0;font-size:100%;line-height:1.42857143;font-family:proxima_nova_rgregular,sans-serif}h2{font-size:18px}
        .loginDiv .mainLogo{display:block;margin-bottom:50px;text-align:center}
        .login-button{display:block;width:100%;background-color:#f44336;color:#fff;line-height:64px;border:0;border-radius:4px;font-size:1.125em;text-transform:uppercase;font-weight:700;text-decoration:none;cursor: pointer;}
        .loginDiv fieldset{width:400px;min-height:120px;padding:45px 32px 30px;margin:0 auto;border:none;border-radius:2px;box-shadow:0 0 6px rgba(26,24,25,.5)}
        .loginDiv fieldset input[type=password]{width:100%;margin-top:10px;margin-bottom:24px;height:40px;padding:0 40px 0 10px;background-color:#f2f0f4;border:none}
        .loginDiv fieldset input[type=password].redHighlight{border: 1px solid #d80000}
        .lockedBlock label:after{content:'\e938';position:absolute;top:0;right:13px;line-height:normal;font-family:icomoon;color:#b7bac0;font-size:20px;font-size:1.25rem}
        input[type=password]:focus+label:after{color:#70a5fb}
        .lockedBlock{position:relative}
    </style>
</head>
<body>
<div>
    <div class="loginDiv">
        <a title="Return to the al alali homepage" class="mainLogo"><img src="..\images\main-logo.png" alt="logo"/></a>
        <form id="changePassForm" action="{{host}}/personnel/passwordChange/{{forgotToken}}" method="post">
            <fieldset>
                <h2>Reset your password</h2>
                <h3>Choose a new password for this user account.</h3>
                <h3>This password will replace the old one.</h3>

                <div class="error"></div>
                <!--<label for="newPass">New Password:</label>-->

                <span class="lockedBlock">
                    <span class="icon"></span>
                    <input type="password"
                           placeholder="New Password"
                           id="pass"
                           name="pass"
                           value=""
                           autofocus
                           maxlength="25"/>
                    <label for="pass"></label>
                </span>
                <div class="error"></div>
                <!--<label for="confirmPass">Confirm Password:</label>-->

                <span class="lockedBlock">
                    <span class="icon"></span>
                    <input type="password"
                           placeholder="Confirm Password"
                           id="confirmPass"
                           name="confirmPass"
                           value=""
                           autofocus
                           maxlength="25"/>
                    <label for="confirmPass"></label>
                </span>
                <input type="submit" class="login-button" value="Change" placeholder="Change">
            </fieldset>
        </form>
    </div>
</div>
<script type="text/javascript">
    var frm = $('#changePassForm');
    var CSRF_TOKEN = $("meta[name='csrf-token']").attr('content');

    function checkForm(form) {
        if (form.pass.value !== form.confirmPass.value) {
            alert("Error: Passwords do not match!");
            form.confirmPass.focus();
            frm.find('#confirmPass').addClass('redHighlight');
            return false;
        }
        return true;
    }

    frm.submit(function (ev) {
        if (checkForm(this)) {
            $.ajax({
                headers: {
                    'X-CSRF-Token': CSRF_TOKEN
                },
                type: frm.attr('method'),
                url: frm.attr('action'),
                data: frm.serialize(),
                success: function (data) {
                    window.location = data;
                },
                error: function (err1, err2) {
                    alert(err1);
                }
            });
        }
        ev.preventDefault();
    });
</script>
</body>
</html>
